- activity = f.object.activity
= f.object.errors.inspect if f.object.errors.any? && Rails.env.development?
- content_for :main_title do
  - action_title_key = ['new', 'create'].include?(action_name) ? 'new' : 'edit'
  - if activity
    - action_title_key << '_specified'
  = "actions.#{controller_path}.#{action_title_key}".t(activity: activity.name)

= field_set do
  -# = f.input :name
  = f.referenced_association :activity, as: :hidden
  - if activity.annual?
    - f.object.campaign ||= current_campaign
    = f.referenced_association :campaign, disabled: f.object.persisted?
  = f.date_range
  - if f.object.use_seasons?
    = f.association :season, as: :radio_buttons, collection: activity.seasons
  - if activity.plant_farming?
    -# Vegetal cropsra
    = f.input :support_nature, as: :radio_buttons
    - f.object.usage ||= :grain
    = f.input :usage
    - if activity && activity.production_system.present?
      - source = { scope: { of_production_system: activity.production_system.name } }
    = f.referenced_association :cultivable_zone, source: source
    - if @land_parcel_naming_format
      - hint = content_tag :span, class: 'hint-warning' do
        = :free_field_naming_format_hint.tl
      = f.input :custom_name, label: :land_parcel_support_name.tl, wrapper: :append, hint: hint do
        = content_tag(:span, :free_field.tl, class: 'add-on')
        = f.input_field :custom_name
        = content_tag(:span, '', data: { support_name_preview: { activity_production: { activity_id: activity.id, campaign_id: current_campaign.id } }})
        = link_to(:configure_naming_format.tl, edit_backend_naming_format_land_parcel_path(@land_parcel_naming_format), target: :_blank)
    = f.shape :support_shape, required: true
    = f.input :irrigated
    = f.input :nitrate_fixing
  - elsif activity.animal_farming?
    -# Animal farming
    = f.referenced_association :support, source: { scope: { of_variety: :animal_group } }, new: {controller: :animal_groups}
    = f.input :size_value, label: :indicative_group_size.tl
  - elsif activity.tool_maintaining?
    = f.input :size_value, label: ActivityProduction.human_attribute_name(:size)
  - elsif activity.with_supports
    -# Other families
    = f.referenced_association :support
  = f.custom_fields
= f.attachments_field_set
